(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{114:function(e,t,a){},115:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(18),l=a.n(c);function i(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var o=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var s=a(17),u=a.n(s),m=a(22),d=a(23),p=a(24),f=a(26),h=a(25),E=a(27),v=a(3),g=a(44),b=a.n(g),k=a(49),w=(a(113),a(45)),y=a.n(w),O=a(21),A=a.n(O),j=function(e){return r.a.createElement(v.c,{multiline:!0},r.a.createElement(v.m,{before:r.a.createElement(v.a,{src:e.info[2]}),description:e.info[1]},e.info[0]),r.a.createElement(v.e,null,r.a.createElement(v.g,{className:"title"},"\u041e \u043d\u0430\u0441"),r.a.createElement(v.e,null,e.info[3]),r.a.createElement(v.g,{className:"title-find"},"\u041a\u043e\u0433\u043e \u043c\u044b \u0438\u0449\u0435\u043c"),r.a.createElement(v.e,null,e.info[6]),r.a.createElement(v.e,{className:"button-cta"},r.a.createElement(v.k,{href:"https://vk.com/im?media=&sel=-120490298",onClick:e.message,target:"_blank"},"\u041e\u0442\u043a\u043b\u0438\u043a\u043d\u0443\u0442\u044c\u0441\u044f"))))},x=a(46),W=a.n(x),N=function(e){return r.a.createElement(v.c,{before:r.a.createElement(W.a,{className:"rating"})},null===e.rating?r.a.createElement(v.t,{size:"small"}):r.a.createElement("span",{className:"rating"},e.rating))},z=function(e){var t=e.user,a=e.itemStyle;return r.a.createElement("div",{style:a},r.a.createElement(v.a,{size:64,style:{marginBottom:4},src:t.photo},!t.photo&&r.a.createElement(A.a,null)),r.a.createElement("div",{style:{marginBottom:6}},t.realName),r.a.createElement("div",{className:"rating",style:{fontSize:14}},375*t.rating))},V=a(19),U=(a(114),function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).readQRCode=function(){V.a.send("VKWebAppOpenQR",{})},a}return Object(E.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props.fetchedUser,a=this.props.organizations,n=this.props.users,c=this.props.rating,l=this.props.go,i={flexShrink:0,width:80,height:120,display:"flex",flexDirection:"column",alignItems:"center",fontSize:12};return r.a.createElement(v.p,{id:this.props.id},r.a.createElement(v.q,null,"Ez Volunteers"),this.props.fetchedUser&&r.a.createElement(v.f,{title:""},r.a.createElement(v.m,{before:t.photo_200?r.a.createElement(v.a,{src:t.photo_200}):null,description:t.city&&t.city.title?"".concat(t.city.title):""},"".concat(t.first_name," ").concat(t.last_name))),t&&r.a.createElement(v.f,null,r.a.createElement(v.c,null,r.a.createElement(v.b,{before:r.a.createElement(y.a,null),size:"l",onClick:function(){return e.readQRCode()}},"\u0421\u0447\u0438\u0442\u0430\u0442\u044c QR-code")),r.a.createElement(v.s,null),r.a.createElement(N,{rating:c})),r.a.createElement(v.f,null,r.a.createElement(v.e,null,r.a.createElement(v.b,{size:"xl",level:"2",onClick:l,"data-to":"aboutPanel"},"\u0422\u0443\u0442\u043e\u0440\u0438\u0430\u043b"))),t&&r.a.createElement(v.f,null,r.a.createElement(v.g,{level:"secondary"},"\u0420\u0435\u0439\u0442\u0438\u043d\u0433 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439"),r.a.createElement(v.i,null,r.a.createElement(v.e,{style:{display:"flex"}},n?n.map(function(e,t){return r.a.createElement(z,{key:t,user:e,itemStyle:i})}):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:Object(k.a)({},i,{paddingLeft:4})},r.a.createElement(v.a,{size:64,style:{marginBottom:8}},r.a.createElement(A.a,null))),r.a.createElement("div",{style:i},r.a.createElement(v.a,{size:64,style:{marginBottom:8}},r.a.createElement(A.a,null))),r.a.createElement("div",{style:i},r.a.createElement(v.a,{size:64,style:{marginBottom:8}},r.a.createElement(A.a,null))))))),r.a.createElement(v.f,{title:"\u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438"},r.a.createElement(v.l,null,a?a.map(function(e,t){return r.a.createElement(j,{key:t,info:e})}):r.a.createElement(r.a.Fragment,null,r.a.createElement(v.c,{className:"load",multiline:!0},r.a.createElement(v.e,{className:"load-div"})),r.a.createElement(v.c,{className:"load",multiline:!0},r.a.createElement(v.e,{className:"load-div"})),r.a.createElement(v.c,{className:"load",multiline:!0},r.a.createElement(v.e,{className:"load-div"})),r.a.createElement(v.c,{className:"load",multiline:!0},r.a.createElement(v.e,{className:"load-div"}))))))}}]),t}(n.Component)),R=a(47),_=a.n(R),C=a(48),M=a.n(C),S=Object(v.v)(),K=function(e){return r.a.createElement(v.p,{id:e.id},r.a.createElement(v.q,{left:r.a.createElement(v.h,{onClick:e.go,"data-to":"mainPanel"},S===v.j?r.a.createElement(_.a,null):r.a.createElement(M.a,null))},"\u041e \u043d\u0430\u0441"),r.a.createElement(v.f,{title:"\u041d\u0430\u0448\u0438 \u0446\u0435\u043b\u0438"},r.a.createElement(v.e,null,"\u0418\u043d\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0431 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f\u0445 \u0438 \u0441\u0432\u044f\u0437\u044b\u0432\u0430\u043d\u0438\u044f \u0441 \u043d\u0438\u043c\u0438 \u0437\u0430\u0438\u043d\u0442\u0435\u0440\u0435\u0441\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043b\u044e\u0434\u0435\u0439.")),r.a.createElement(v.f,{title:"\u041a\u0430\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0441\u044c\u044f"},r.a.createElement(v.l,null,r.a.createElement(v.c,null,"\u041f\u0440\u043e\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u0439 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438."),r.a.createElement(v.c,null,"\u041e\u0442\u043a\u043b\u0438\u043a\u0430\u0439\u0441\u044f \u043d\u0430 \u0438\u043d\u0442\u0435\u0440\u0435\u0441\u043d\u0443\u044e."),r.a.createElement(v.c,null,"\u041f\u043e\u043c\u043e\u0433\u0430\u0439 \u043b\u044e\u0434\u044f\u043c!"))),r.a.createElement(v.f,{title:"\u041f\u043e\u043b\u0443\u0447\u0430\u0439 \u0440\u0435\u0439\u0442\u0438\u043d\u0433"},r.a.createElement(v.e,null,"\u041f\u043e\u0441\u0435\u0449\u0430\u0439 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f, \u043e\u0442\u043c\u0435\u0447\u0430\u0439\u0441\u044f \u043f\u043e qr \u043a\u043e\u0434\u0443 \u0438 \u043f\u043e\u043b\u0443\u0447\u0430\u0439 \u0437\u0430 \u044d\u0442\u043e \u0431\u0430\u043b\u044b.")))},P=a(31),I=a.n(P),T=b.a.isWebView(),B=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(f.a)(this,Object(h.a)(t).call(this,e))).go=function(e){a.setState({activePanel:e.currentTarget.dataset.to})},a.getOrganizations=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://volunteervkmini.herokuapp.com/public/api/organisation");case 2:return t=e.sent,e.next=5,t.json();case 5:return a.sheetsdata=e.sent,e.abrupt("return",a.sheetsdata);case 7:case"end":return e.stop()}},e)})),a.getRating=Object(m.a)(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:setInterval(function(){a.setState({rating:3600})},4e3);case 1:case"end":return e.stop()}},e)})),a.checkUserLocation=function(){var e=Object(m.a)(u.a.mark(function e(t){var n,r,c;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.hasOwnProperty("qr_data")){e.next=12;break}return n=t.qr_data.split(","),r="https://volunteervkmini.herokuapp.com/public/api/geolocation/calc/".concat(n[0].trim(),"/").concat(n[1].trim()),e.next=5,fetch(r,{method:"get"});case 5:return c=e.sent,e.next=8,c.text();case 8:"OK"===e.sent?a.setActiveModal("access"):a.setActiveModal("deny"),e.next=12;break;case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.getOtherUsers=function(){var e=Object(m.a)(u.a.mark(function e(t){var n,r,c;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://volunteervkmini.herokuapp.com/public/api/rating");case 2:return n=e.sent,e.next=5,n.json();case 5:r=e.sent,c=[],r.forEach(function(e){c.push(e.name)}),a.setState({users:r}),V.a.send("VKWebAppCallAPIMethod",{method:"users.get",request_id:"32test",params:{user_ids:c.join(", "),v:"5.101",access_token:t,fields:"photo_200"}});case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.addRatingUsers=function(e){var t=a.state.users;e.forEach(function(e,a){t[a].photo=e.photo_200,t[a].realName=e.first_name}),setInterval(function(){a.setState({users:t})},1e3)},a.state={activePanel:"mainPanel",fetchedUser:null,rating:null,organizations:null,activeModal:null,users:null},a}return Object(E.a)(t,e),Object(p.a)(t,[{key:"componentWillMount",value:function(){var e=this;V.a.subscribe(function(t){switch(t.detail.type){case"VKWebAppGetUserInfoResult":e.setState({fetchedUser:t.detail.data});break;case"VKWebAppOpenQRResult":e.checkUserLocation(t.detail.data);break;case"VKWebAppAccessTokenReceived":e.getOtherUsers(t.detail.data.access_token);break;case"VKWebAppAccessTokenFailed":break;case"VKWebAppCallAPIMethodResult":e.addRatingUsers(t.detail.data.response);break;case"VKWebAppOpenQRFailed":break;default:console.log(t.detail.type)}}),V.a.send("VKWebAppInit",{}),V.a.send("VKWebAppGetUserInfo",{}).then(function(t){e.getRating()}),V.a.send("VKWebAppGetAuthToken",{app_id:7133183,scope:"users.get"}),this.getOrganizations().then(function(t){setInterval(function(){e.setState({organizations:t})},4e3)})}},{key:"render",value:function(){var e=this;return r.a.createElement(v.d,{insets:this.props.insets,isWebView:T},r.a.createElement(v.r,{activeView:"mainView"},r.a.createElement(v.u,{id:"mainView",activePanel:this.state.activePanel},r.a.createElement(U,{fetchedUser:this.state.fetchedUser,id:"mainPanel",accessToken:this.props.accessToken,go:this.go,modal:this.checkUserLocation,token:this.state.token,organizations:this.state.organizations,rating:this.state.rating,users:this.state.users}),r.a.createElement(K,{id:"aboutPanel",go:this.go}))),r.a.createElement(v.o,{activeModal:this.state.activeModal},r.a.createElement(v.n,{id:"access",onClose:function(){return e.setActiveModal(null)},icon:r.a.createElement(I.a,null),title:"\u0412\u0430\u0448\u0435 \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u043e"}),r.a.createElement(v.n,{id:"deny",onClose:function(){return e.setActiveModal(null)},icon:r.a.createElement(I.a,null),title:"\u041d\u0435 \u0432 \u0437\u043e\u043d\u0435 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f"})))}},{key:"setActiveModal",value:function(e){this.setState({activeModal:e})}}]),t}(n.Component);l.a.render(r.a.createElement(B,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/volunteer",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/volunteer","/service-worker.js");o?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):i(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):i(e)})}}()},98:function(e,t,a){e.exports=a(115)}},[[98,1,2]]]);
//# sourceMappingURL=main.af7dd28c.chunk.js.map